<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>ğŸ’° Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­Ø§Ù…ÙŠ</title>
  <style>
    body {
      background-color: #121212;
      color: white;
      font-family: Arial;
      text-align: center;
      padding: 30px;
    }
    input, button {
      margin: 10px;
      padding: 10px;
      font-size: 16px;
    }
    .actions {
      margin-top: 20px;
    }
    .balances {
      margin-top: 40px;
      border-top: 1px solid #555;
      padding-top: 20px;
      text-align: right;
      direction: rtl;
    }
  </style>
</head>
<body>
  <h2>ğŸ’° Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­Ø§Ù…ÙŠ</h2>

  <input type="text" id="lawyer-username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ø§Ù„Ù…Ø­Ø§Ù…ÙŠ)">
  <input type="number" id="amount" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡">

  <div class="actions">
    <button onclick="addBalance()">â• Ø¥Ø¶Ø§ÙØ©</button>
    <button onclick="deductBalance()">â– Ø®ØµÙ…</button>
    <button onclick="resetBalance()">ğŸ§¹ ØªØµÙÙŠØ± Ø±ØµÙŠØ¯</button>
    <button onclick="showAllBalances()">ğŸ“‹ Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„Ø£Ø±ØµØ¯Ø©</button>
  </div>

  <div class="balances" id="balances-list">
    <!-- Ù‡Ù†Ø§ Ù‡ØªØ¸Ù‡Ø± ÙƒÙ„ Ø§Ù„Ø£Ø±ØµØ¯Ø© -->
  </div>

  <script>
    function getBalanceKey(username) {
      return `balance_${username}`;
    }

    function getSpentKey(username) {
      return `spent_${username}`;
    }

    function addBalance() {
      const username = document.getElementById("lawyer-username").value.trim();
      const amount = parseFloat(document.getElementById("amount").value);

      if (!username || isNaN(amount) || amount <= 0) {
        alert("âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… ÙˆÙ…Ø¨Ù„Øº ØµØ­ÙŠØ­.");
        return;
      }

      // Ù„Ùˆ Ø§Ù„Ù…Ø­Ø§Ù…ÙŠ Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ localStorage Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©ØŒ Ù†Ø¨Ø¯Ø£ Ø¨Ù€ 0
      let current = parseFloat(localStorage.getItem(getBalanceKey(username))) || 0;
      let updated = current + amount;
      localStorage.setItem(getBalanceKey(username), updated);

      alert(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© ${amount} Ø¬Ù†ÙŠÙ‡ Ø¥Ù„Ù‰ ${username}.`);
      showAllBalances();
    }

    function deductBalance() {
      const username = document.getElementById("lawyer-username").value.trim();
      const amount = parseFloat(document.getElementById("amount").value);

      if (!username || isNaN(amount) || amount <= 0) {
        alert("âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… ÙˆÙ…Ø¨Ù„Øº ØµØ­ÙŠØ­.");
        return;
      }

      const balanceKey = getBalanceKey(username);
      const spentKey = getSpentKey(username);

      if (!localStorage.getItem(balanceKey)) {
        alert("âŒ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯.");
        return;
      }

      let currentBalance = parseFloat(localStorage.getItem(balanceKey)) || 0;
      let currentSpent = parseFloat(localStorage.getItem(spentKey)) || 0;
      let available = currentBalance - currentSpent;

      if (amount > available) {
        alert(`âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø®ØµÙ… ${amount} Ø¬Ù†ÙŠÙ‡ Ù„Ø£Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­ Ù‡Ùˆ ${available} Ø¬Ù†ÙŠÙ‡ ÙÙ‚Ø·.`);
        return;
      }

      let newSpent = currentSpent + amount;
      localStorage.setItem(spentKey, newSpent);

      alert(`âœ… ØªÙ… Ø®ØµÙ… ${amount} Ø¬Ù†ÙŠÙ‡ Ù…Ù† ${username}.`);
      showAllBalances();
    }

    function resetBalance() {
      const username = document.getElementById("lawyer-username").value.trim();
      if (!username) {
        alert("âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….");
        return;
      }

      const balanceKey = getBalanceKey(username);
      const spentKey = getSpentKey(username);

      if (!localStorage.getItem(balanceKey)) {
        alert("âŒ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯.");
        return;
      }

      if (confirm(`âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØµÙÙŠØ± Ø­Ø³Ø§Ø¨ ${username}ØŸ`)) {
        localStorage.removeItem(balanceKey);
        localStorage.removeItem(spentKey);
        alert(`ğŸ§¹ ØªÙ… ØªØµÙÙŠØ± Ø­Ø³Ø§Ø¨ ${username}.`);
        showAllBalances();
      }
    }

    function showAllBalances() {
      const balancesDiv = document.getElementById("balances-list");
      balancesDiv.innerHTML = "";

      let found = false;

      for (let key in localStorage) {
        if (key.startsWith("balance_")) {
          let username = key.replace("balance_", "");
          let totalAdded = parseFloat(localStorage.getItem(getBalanceKey(username))) || 0;
          let totalSpent = parseFloat(localStorage.getItem(getSpentKey(username))) || 0;
          let net = totalAdded - totalSpent;

          balancesDiv.innerHTML += `<p>ğŸ‘¤ <strong>${username}</strong> â€” ğŸ’° Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: ${net} Ø¬Ù†ÙŠÙ‡ (ØªÙ… Ø¥Ø¶Ø§ÙØ©: ${totalAdded} - Ù…ØµØ±ÙˆÙ: ${totalSpent})</p>`;
          found = true;
        }
      }

      if (!found) {
        balancesDiv.innerHTML = "<p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£Ø±ØµØ¯Ø© Ù…Ø³Ø¬Ù„Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.</p>";
      }
    }

    window.onload = showAllBalances;
  </script>
</body>
</html>
